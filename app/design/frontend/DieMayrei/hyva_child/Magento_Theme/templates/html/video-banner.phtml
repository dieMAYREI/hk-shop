<?php

/**
 * Video Banner Template
 * Displays a responsive video banner above the footer with lazy loading
 */

declare(strict_types=1);

use Magento\Framework\View\Element\Template;
use Magento\Framework\Escaper;

/** @var Template $block */
/** @var Escaper $escaper */

$desktopVideo = $block->getViewFileUrl('videos/dlv_Shop_AD_Banner_HK_1488x480.mp4');
$mobileVideo = $block->getViewFileUrl('videos/dlv_Shop_AD_Banner_HK_375x175.mp4');
?>

<section class="video-banner container mx-auto px-4 py-6"
    x-data="{ isVisible: false, isMobile: window.innerWidth < 768 }"
    x-intersect:enter="isVisible = true">
    <a href="https://www.dlv-shop.de/" target="_blank" rel="noopener">
        <div class="relative w-full overflow-hidden rounded-lg aspect-[375/175] md:aspect-[1488/480]">
            
            <!-- Loading Background -->
            <div class="absolute inset-0 bg-gray-300 animate-pulse"></div>
            
            <!-- Desktop Video -->
            <video
                class="hidden md:block w-full h-full object-cover relative"
                muted
                loop
                playsinline
                autoplay
                preload="none"
                :src="isVisible && !isMobile ? '<?= $escaper->escapeUrl($desktopVideo) ?>' : ''">
            </video>

            <!-- Mobile Video -->
            <video
                class="md:hidden w-full h-full object-cover relative"
                muted
                loop
                playsinline
                autoplay
                preload="none"
                :src="isVisible && isMobile ? '<?= $escaper->escapeUrl($mobileVideo) ?>' : ''">
            </video>
        </div>
    </a>
</section>